# Image upload

## Mục tiêu
- Cho phép người dùng admin upload nhiều ảnh ảnh lên trang tin tức
- Lưu trữ đường dẫn ảnh trong database để phục vụ cho việc hiển thị sau này.

## Triển khai
1. **Clients gửi request**
- Gửi yêu cầu đến API `POST /api/news` để tạo tin tức mới, sử dụng `multipart/form-data` để đính kém file các file ảnh cùng các trường dữ liệu khác.
- Bổ sung về `multipart/form-data`:
  What?
    - Là 1 kiểu Content-Type dành riêng cho HTTP method `POST`, `PUT`.
    - Dùng để upload nhiều định dạng dữ liệu khác nhau như text, file.

  Why?
    - Cách duy nhất để upload file.
2. **Handle nhận request**
- Handler nhận request, đọc file ảnh từ form-data thông qua hàm `ctx.FormFile("news-image")` của Gin.
- Thực hiện validate file (kiểm tra định dạng, kích thước,...)

3. **Uplaod file ảnh**
- Lưu file ảnh vào thư mục lưu trữ trên server (ví dụ: thư mục `uploads`)
- Sinh tên file duy nhất bằng UUID
- Tạo đường dẫn public cho ảnh, ví dụ thông qua `router.Static("/images, "./uploads")`
[`http://<server_host>`](http://<server_host>:<port>/images/<tên_file>)

4. Lưu đường dẫn vào database
- Lưu đường dẫn này vào database (trường `image` của bảng `news`)

5. Client sử dụng
```json
{
  "message": "News post created successfully.",
  "data": {
    "id": 123,
    "title": "Tin mới",
    "image": "http://localhost:8080/images/abc123.jpg",
    ...
  }
}
```
## Hướng cải tiến
- Cân nhắc các phương án lưu ảnh như:
  - S3: giúp mở rộng, dễ quản lý, giảm bớt chiếm dụng tài nguyên
  - MinIO: giúp mở rộng, dễ quản lý
  - Kết hợp CDN nếu cần truy cập toàn cầu
- Thêm chức năng nén ảnh trước khi lưu.